\documentclass[CJKutf8,xcolor=pdftex,dvipsnames,table]{report}
\usepackage{hyperref}
\hypersetup{
  pdftitle={Operating System Concepts},
  pdfauthor={Hong MingJian},
  pdfsubject={The EPOS Source code},
%  pdfpagemode={FullScreen},
  colorlinks={true},
  linkcolor={blue},
}
\usepackage{CJKutf8}
\usepackage{epic} % for \dashline
\usepackage{listings}
\usepackage{courier}
\usepackage{pgffor} % for \foreach

\lstset{
  basicstyle=\small\ttfamily,
  tabsize=2,
  breaklines=false,
%  keywordstyle=\color{blue},
%  identifierstyle=,
%  commentstyle=\color{green},
%  stringstyle=,
%  showstringspaces=false,
%  extendedchars=false
%  numberstyle=\tiny,
  numbers=left,
  stepnumber=1,
  firstnumber=1,
  numberfirstline=true,
  frame=tb
}

%\renewcommand\lstlistingname{File}
%\renewcommand\lstlistlistingname{The EPOS source code}

\title{THE EPOS SOURCE CODE}
\author{洪明坚\ 重庆大学软件学院}
\date{2014年10月}

\begin{document}
\begin{CJK*}{UTF8}{songti}

\maketitle

\lstlistoflistings

\newpage
\lstinputlisting[language={[gnu]make},label=Makefile,caption=Makefile]{../Makefile}
\newpage
\lstinputlisting[language={[gnu]make},label=Makefile.inc,caption=Makefile.inc]{../Makefile.inc}

\newpage
\lstinputlisting[label=include/syscall-nr.h,caption=include/syscall-nr.h]{../include/syscall-nr.h}

\newpage
\lstinputlisting[language={[gnu]make},label=kernel/Makefile,caption=kernel/Makefile]{../kernel/Makefile}
\newpage
\lstinputlisting[label=kernel/ldscript,caption=kernel/ldscript]{../kernel/ldscript}
\newpage
\lstinputlisting[label=kernel/entry.S,caption=kernel/entry.S]{../kernel/entry.S}
\foreach \n in
{machdep.c,startup.c,task.c,page.c,frame.c,timer.c,kbd.c,cpu.h,kernel.h,machdep.h}{\newpage
\lstinputlisting[language=C,label=kernel/\n,caption=kernel/\n]{../kernel/\n}}

\newpage
\lstinputlisting[language={[gnu]make},label=userapp/Makefile,caption=userapp/Makefile]{../userapp/Makefile}
\newpage
\lstinputlisting[label=userapp/lib/crt0.S,caption=userapp/lib/crt0.S]{../userapp/lib/crt0.S}
\newpage
\lstinputlisting[language=C,label=userapp/main.c,caption=userapp/main.c]{../userapp/main.c}
\newpage
\lstinputlisting[label=userapp/lib/syscall-wrapper.S,caption=userapp/lib/syscall-wrapper.S]{../userapp/lib/syscall-wrapper.S}
\newpage
\lstinputlisting[language=C,label=userapp/include/syscall.h,caption=userapp/include/syscall.h]{../userapp/include/syscall.h}

\end{CJK*}
\end{document}
